<?xml version="1.0" encoding="UTF-8"?>
<project name="build-all-lang">
    <property name="src.dir" location="lang\"/>
    <property name="dst.dir" location="src\lang\"/>

    <target name="build-lang" depends="init,-do-build-lang,-post-build-lang" description="Process the grammar files with ANTLR4." />
    <target name="-build-lang-pre-init">
        <property name="do.depend" value="true"/>
    </target>
    
    <target name="-do-build-lang">



        <mkdir dir="${dst.dir}"/>

        <pathconvert property="list.0" pathsep="' '" >
            <fileset dir="${src.dir}">
                <include name="*.g4"/>
            </fileset>
            <mapper type="glob" from="${src.dir}${file.separator}*.g4" to="*.g4"/>
        </pathconvert>
        <property name="list" value="'${list.0}'"/>

        <echo> > Generate : ${list}</echo>
        <echo> > From     : ${src.dir}</echo>
        <echo> > To       : ${dst.dir}</echo>

        <java classname="org.antlr.v4.Tool" fork="true" dir="${src.dir}" failonerror="true">
            <arg value="-visitor"/>
            <arg value="-o"/>
            <arg path="${dst.dir}"/>
            <arg value="-lib"/>
            <arg path="${dst.dir}"/>
            <arg line="${list}"/>
            <classpath>
                <pathelement path="${javac.classpath}"/>
            </classpath>

            <jvmarg value="-Xmx512M"/>
        </java>

    </target>


    <target name="-post-build-lang">
        <echo> > Complete </echo>
    </target>

</project>